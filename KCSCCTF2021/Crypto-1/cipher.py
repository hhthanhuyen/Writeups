from flag import FLAG
import base64
from os import urandom

assert FLAG[:4] == b"KCSC"

sbox = [100, 188, 58, 84, 120, 128, 211, 143, 150, 32, 114, 40, 25, 77, 103, 136, 245, 212, 196, 39, 254, 244, 121, 154, 176, 86, 139, 96, 133, 250, 55, 112, 214, 228, 60, 0, 107, 9, 79, 68, 23, 173, 132, 19, 36, 83, 124, 17, 115, 205, 144, 163, 70, 93, 75, 203, 65, 18, 201, 168, 208, 78, 182, 87, 231, 101, 213, 71, 197, 218, 157, 52, 59, 98, 229, 253, 47, 177, 232, 35, 106, 215, 116, 20, 21, 160, 233, 198, 227, 5, 134, 234, 38, 126, 102, 61, 89, 11, 12, 43, 54, 95, 16, 91, 166, 44, 62, 137, 140, 130, 15, 238, 113, 105, 142, 81, 252, 99, 46, 74, 191, 247, 72, 7, 174, 151, 221, 152, 255, 195, 220, 240, 223, 90, 206, 159, 185, 165, 145, 94, 217, 153, 30, 4, 192, 92, 189, 181, 224, 110, 27, 210, 26, 226, 161, 199, 158, 200, 85, 235, 42, 104, 24, 237, 171, 183, 216, 146, 125, 187, 243, 242, 66, 29, 135, 73, 119, 53, 56, 239, 131, 69, 172, 109, 156, 155, 249, 50, 248, 164, 175, 64, 246, 82, 57, 14, 111, 48, 178, 118, 241, 225, 117, 123, 162, 186, 170, 28, 202, 236, 67, 230, 10, 97, 76, 207, 8, 1, 180, 88, 34, 251, 204, 148, 6, 13, 184, 209, 33, 2, 80, 63, 141, 169, 222, 193, 219, 149, 194, 147, 179, 37, 3, 31, 108, 45, 127, 41, 190, 138, 167, 49, 129, 22, 122, 51]


key = int.from_bytes(urandom(16),"big") # 16-byte key
ciphertext = list(FLAG)

for i in range(256):
    key = (key + i) % 256
    ciphertext = [f ^ key for f in ciphertext]
    ciphertext = [sbox[f] for f in ciphertext]

ciphertext = base64.b64encode(bytes(ciphertext)).decode()
print(ciphertext)

# aQifCFOLhkU20DPLhkU20B7L9wJS0J9xDsvL9TY2NtDQ0NDQVuhq6J8w98to13xSzHdF6FIwaOiGReh8aOhFy8v3RWro3Mg=
